<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <title>Eğitim Platformu | Giriş</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ✅ DOĞRU CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">
</head>

<body class="hold-transition login-page">
<div class="login-box">
  <div class="login-logo">
    <b>Eğitim</b>Platformu
  </div>

  <div class="card">
    <div class="card-body login-card-body">

      {% if role_key == "student" %}
        <h5 class="text-center mb-2"><i class="fas fa-user-graduate"></i> Öğrenci Girişi</h5>
        <p class="text-muted text-center mb-3">Derslere, ödevlere ve sınavlara buradan ulaşabilirsiniz.</p>
      {% elif role_key == "teacher" %}
        <h5 class="text-center mb-2"><i class="fas fa-chalkboard-teacher"></i> Öğretmen Girişi</h5>
        <p class="text-muted text-center mb-3">Görev, içerik ve öğrenci takibini buradan yönetirsiniz.</p>
      {% elif role_key == "parent" %}
        <h5 class="text-center mb-2"><i class="fas fa-users"></i> Veli Girişi</h5>
        <p class="text-muted text-center mb-3">Öğrencinizin planını ve ilerlemesini buradan takip edebilirsiniz.</p>
      {% else %}
        <h5 class="text-center mb-2"><i class="fas fa-user-shield"></i> Yönetici Girişi</h5>
        <p class="text-muted text-center mb-3">Yönetim paneline erişim.</p>
      {% endif %}

      {% if messages %}
        {% for m in messages %}
          <div class="alert alert-{{ m.tags|default:'info' }}">{{ m }}</div>
        {% endfor %}
      {% endif %}

      {% if form.errors %}
        <div class="alert alert-danger">Kullanıcı adı veya parola hatalı.</div>
      {% endif %}

      <form method="post">
        {% csrf_token %}

        <!-- ✅ Role göre doğru gate -->
        {% if role_key == "admin" %}
          <input type="hidden" name="next" value="/gate/admin/">
        {% elif role_key == "teacher" %}
          <input type="hidden" name="next" value="/gate/teacher/">
        {% elif role_key == "parent" %}
          <input type="hidden" name="next" value="/gate/parent/">
        {% else %}
          <input type="hidden" name="next" value="/gate/student/">
        {% endif %}

        <div class="input-group mb-3">
          <input type="text" name="username" class="form-control" placeholder="Kullanıcı adı" required>
          <div class="input-group-append">
            <div class="input-group-text"><span class="fas fa-user"></span></div>
          </div>
        </div>

        <div class="input-group mb-3">
          <input id="passwordInput" type="password" name="password" class="form-control" placeholder="Parola" required>
          <div class="input-group-append">
            <button type="button" class="btn btn-default" id="togglePass" title="Göster/Gizle">
              <i class="fas fa-eye" id="eyeIcon"></i>
            </button>
          </div>
        </div>

        <div class="row">
          <div class="col-7">
            <div class="icheck-primary">
              <input type="checkbox" id="remember">
              <label for="remember">Beni hatırla</label>
            </div>
          </div>
          <div class="col-5">
            <button type="submit" class="btn btn-primary btn-block">Giriş</button>
          </div>
        </div>
      </form>

      <div class="mt-3 d-flex justify-content-between">
        <a href="/password-reset/"><i class="fas fa-key"></i> Şifremi unuttum</a>
        <div>
          <a href="/login/student/">Öğrenci</a> |
          <a href="/login/teacher/">Öğretmen</a> |
          <a href="/login/parent/">Veli</a> |
          <a href="/login/admin/">Yönetici</a>
        </div>
      </div>

      <hr>
      <p class="mb-0 text-center">
        <small>© {% now "Y" %} Eğitim Platformu</small>
      </p>

    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>

<script>
  // Parola göster/gizle
  (function(){
    const inp = document.getElementById("passwordInput");
    const btn = document.getElementById("togglePass");
    const icon = document.getElementById("eyeIcon");
    if(!inp || !btn || !icon) return;

    btn.addEventListener("click", function(){
      const isPass = inp.type === "password";
      inp.type = isPass ? "text" : "password";
      icon.classList.toggle("fa-eye");
      icon.classList.toggle("fa-eye-slash");
    });
  })();
</script>

</body>
</html>
